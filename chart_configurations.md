# ç¾è‚¡å¤§ç›˜ç›‘æ§çœ‹æ¿ - å›¾è¡¨é…ç½®

## ğŸ“ˆ å›¾è¡¨1: å¤§ç›˜æŒ‡æ•°èµ°åŠ¿å›¾ (æŠ˜çº¿å›¾)

### å›¾è¡¨ç±»å‹é€‰æ‹©ä¾æ®
**ä¸ºä»€ä¹ˆé€‰æ‹©æŠ˜çº¿å›¾ï¼Ÿ**
1. **æ—¶é—´åºåˆ—æœ€ä½³å®è·µ**ï¼šæŠ˜çº¿å›¾æ˜¯å±•ç¤ºæ—¶é—´åºåˆ—æ•°æ®çš„æ ‡å‡†é€‰æ‹©ï¼Œèƒ½æ¸…æ™°æ˜¾ç¤ºè¶‹åŠ¿ã€æ³¢åŠ¨å’Œè½¬æŠ˜ç‚¹[citation:5]
2. **è¶‹åŠ¿å¯è§†åŒ–**ï¼šè¿ç»­çº¿æ¡æœ‰åŠ©äºè¯†åˆ«é•¿æœŸè¶‹åŠ¿ã€æ”¯æ’‘/é˜»åŠ›ä½å’Œå…³é”®çªç ´ç‚¹
3. **å¤šç³»åˆ—å¯¹æ¯”**ï¼šå¯å åŠ å¤šæ¡çº¿ï¼ˆå¦‚SPY vs ç§»åŠ¨å¹³å‡çº¿ï¼‰ï¼Œä¾¿äºæŠ€æœ¯åˆ†æ
4. **ç”¨æˆ·ç†Ÿæ‚‰åº¦**ï¼šæŠ•èµ„è€…æœ€ç†Ÿæ‚‰çš„é‡‘èå›¾è¡¨ç±»å‹ï¼Œé™ä½è®¤çŸ¥è´Ÿæ‹…

### å­—æ®µæ˜ å°„é…ç½®
| é…ç½®é¡¹ | å­—æ®µ/å€¼ | è¯´æ˜ |
|--------|---------|------|
| **Xè½´** | `date` | äº¤æ˜“æ—¥æ—¥æœŸï¼Œæ ¼å¼: "YYYY-MM-DD" |
| **Yè½´** | `close` | æ”¶ç›˜ä»· (ä¸»åæ ‡è½´ï¼Œå·¦ä¾§) |
| **Y2è½´** | `volume` | æˆäº¤é‡ (å‰¯åæ ‡è½´ï¼Œå³ä¾§ï¼Œå¯é€‰) |
| **å›¾ä¾‹** | `symbol` | å›ºå®šæ˜¾ç¤º: "SPY (S&P 500 ETF)" |
| **é¢œè‰²** | `#1f77b4` | æ ‡å‡†è“è‰²ï¼Œè¡¨ç¤ºå¤§ç›˜æŒ‡æ•° |
| **çº¿å‹** | å®çº¿ | ä¸»è¶‹åŠ¿çº¿ï¼Œå®½åº¦: 2px |
| **è¾…åŠ©çº¿** | ç§»åŠ¨å¹³å‡çº¿ | å¯å åŠ 20æ—¥/50æ—¥/200æ—¥å‡çº¿ |

### ç­›é€‰å™¨é…ç½®
| ç­›é€‰å™¨ | é€‰é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| æ—¶é—´èŒƒå›´ | YTD, MTD, 3M, 6M, 1Y, è‡ªå®šä¹‰ | YTD | å¹´åˆè‡³ä»Š |
| æŠ€æœ¯æŒ‡æ ‡ | MA(20), MA(50), MA(200), Bollinger | MA(20) | ç§»åŠ¨å¹³å‡çº¿ |
| ä»·æ ¼ç±»å‹ | æ”¶ç›˜ä»·, è°ƒæ•´æ”¶ç›˜ä»·, å¼€ç›˜ä»· | æ”¶ç›˜ä»· | ä»·æ ¼æ•°æ®é€‰æ‹© |

### æ•°æ®é¢„å¤„ç†
```python
# è®¡ç®—YTDæ•°æ® (ä»2026å¹´ç¬¬ä¸€ä¸ªäº¤æ˜“æ—¥å¼€å§‹)
def prepare_spy_ytd(df):
    df['date'] = pd.to_datetime(df['date'])
    # ç­›é€‰2026å¹´æ•°æ®
    ytd_data = df[df['date'].dt.year == 2026].copy()
    # è®¡ç®—YTDæ”¶ç›Šç‡ (ä»¥ç¬¬ä¸€ä¸ªäº¤æ˜“æ—¥ä¸ºåŸºå‡†)
    first_close = ytd_data.iloc[0]['close']
    ytd_data['ytd_return'] = (ytd_data['close'] - first_close) / first_close * 100
    return ytd_data
```

## ğŸ“Š å›¾è¡¨2: ä¸ªè‚¡è¡¨ç°çŸ©é˜µ

### å›¾è¡¨ç±»å‹é€‰æ‹©ä¾æ®
**ä¸ºä»€ä¹ˆé€‰æ‹©å¤šç³»åˆ—æŠ˜çº¿å›¾/é¢ç§¯å›¾ç»„åˆï¼Ÿ**
1. **æ¯”è¾ƒåˆ†æ**ï¼šå¹¶æ’æ˜¾ç¤ºå¤šæ¡çº¿ï¼Œä¾¿äºæ¯”è¾ƒä¸åŒè‚¡ç¥¨èµ°åŠ¿[citation:5]
2. **ç›¸å¯¹å¼ºå¼±**ï¼šå¯è®¡ç®—ç›¸å¯¹äºSPYçš„è¶…é¢æ”¶ç›Šï¼Œæ˜¾ç¤ºAlpha
3. **äº¤äº’å¯¹æ¯”**ï¼šæ”¯æŒæ‚¬åœå¯¹æ¯”åŒä¸€æ—¶é—´ç‚¹çš„å¤šä¸ªè‚¡ä»·
4. **ç©ºé—´æ•ˆç‡**ï¼šå•å›¾å®¹çº³å¤šä¸ªç»´åº¦ï¼ŒèŠ‚çœçœ‹æ¿ç©ºé—´

### å­—æ®µæ˜ å°„é…ç½®
| é…ç½®é¡¹ | å­—æ®µ/å€¼ | è¯´æ˜ |
|--------|---------|------|
| **Xè½´** | `date` | äº¤æ˜“æ—¥æ—¥æœŸï¼Œä¸å¤§ç›˜å›¾åŒæ­¥ |
| **Yè½´** | `close` | æ”¶ç›˜ä»·ï¼ŒæŒ‰æ¯”ä¾‹æ ‡å‡†åŒ–æ˜¾ç¤º |
| **å›¾ä¾‹** | `symbol` | NVDA, AAPL, CRM, IBM, SPY(åŸºå‡†) |
| **é¢œè‰²æ–¹æ¡ˆ** | åˆ†ç±»è‰²æ¿ | æ¯åªè‚¡ç¥¨å›ºå®šé¢œè‰²: NVDA(ç»¿), AAPL(è“), CRM(æ©™), IBM(ç´«) |
| **å›¾è¡¨ç±»å‹** | æŠ˜çº¿å›¾ | ä¸»æ˜¾ç¤º: ä»·æ ¼èµ°åŠ¿ |
| **è¾…åŠ©æ˜¾ç¤º** | é¢ç§¯å›¾ | å¯é€‰: æ˜¾ç¤ºè¶…é¢æ”¶ç›ŠåŒºåŸŸ |

### å…³é”®æŒ‡æ ‡è®¡ç®—
| æŒ‡æ ‡ | è®¡ç®—å…¬å¼ | æ˜¾ç¤ºæ ¼å¼ |
|------|----------|----------|
| **æœ¬æœˆæ¶¨å¹…** | (æœ¬æœˆæœ«æ”¶ç›˜ - æœ¬æœˆåˆæ”¶ç›˜) / æœ¬æœˆåˆæ”¶ç›˜ | +X.XX% |
| **YTDæ¶¨å¹…** | (å½“å‰æ”¶ç›˜ - å¹´åˆæ”¶ç›˜) / å¹´åˆæ”¶ç›˜ | +X.XX% |
| **æ—¥å‡æˆäº¤é‡** | æœˆå†…æˆäº¤é‡å¹³å‡å€¼ | X.XXM è‚¡ |
| **ç›¸å¯¹SPYè¡¨ç°** | è‚¡ç¥¨YTDæ¶¨å¹… - SPY YTDæ¶¨å¹… | +X.XX% (è¶…é¢) |

### äº¤äº’åŠŸèƒ½
1. **è‚¡ç¥¨é€‰æ‹©**ï¼šå¤é€‰æ¡†é€‰æ‹©æ˜¾ç¤º/éšè—ç‰¹å®šè‚¡ç¥¨
2. **åŸºå‡†åˆ‡æ¢**ï¼šå¯åˆ‡æ¢å¯¹æ¯”åŸºå‡† (SPY/è¡Œä¸šæŒ‡æ•°)
3. **æ ‡å‡†åŒ–æ˜¾ç¤º**ï¼šå¯é€‰ä»·æ ¼æ ‡å‡†åŒ–(ä»¥èµ·å§‹æ—¥=100)
4. **è¯¦ç»†è§†å›¾**ï¼šç‚¹å‡»è‚¡ç¥¨è·³è½¬åˆ°ä¸ªè‚¡è¯¦æƒ…é¡µ

## ğŸ¥§ å›¾è¡¨3: æˆäº¤é‡åˆ†å¸ƒå›¾ (é¥¼å›¾)

### å›¾è¡¨ç±»å‹é€‰æ‹©ä¾æ®
**ä¸ºä»€ä¹ˆé€‰æ‹©é¥¼å›¾/ç¯å½¢å›¾ï¼Ÿ**
1. **å æ¯”å±•ç¤º**ï¼šé¥¼å›¾å¤©ç„¶é€‚åˆæ˜¾ç¤ºéƒ¨åˆ†ä¸æ•´ä½“çš„å…³ç³»[citation:5]
2. **ç›´è§‚ç†è§£**ï¼šæŠ•èµ„è€…å®¹æ˜“ç†è§£"å¸‚åœºä»½é¢"æ¦‚å¿µ
3. **å¤šçº§é’»å–**ï¼šå¯ä»è¡Œä¸šé’»å–åˆ°ä¸ªè‚¡æˆäº¤é‡åˆ†å¸ƒ
4. **è§†è§‰å¸å¼•åŠ›**ï¼šè‰²å½©åŒºåˆ†æ˜ç¡®ï¼Œçªå‡ºé‡ç‚¹è¡Œä¸š

### å­—æ®µæ˜ å°„é…ç½®
| é…ç½®é¡¹ | å­—æ®µ/å€¼ | è¯´æ˜ |
|--------|---------|------|
| **æ•°æ®é¡¹** | `symbol` | è‚¡ç¥¨ä»£ç ä½œä¸ºåˆ†ç±» |
| **æ•°å€¼** | `volume` | æˆäº¤é‡ (éœ€æŒ‰å‘¨æœŸèšåˆ) |
| **æ ‡ç­¾** | `symbol` + å æ¯” | æ˜¾ç¤ºè‚¡ç¥¨ä»£ç å’Œç™¾åˆ†æ¯” |
| **é¢œè‰²** | ä¸ä¸ªè‚¡çŸ©é˜µä¸€è‡´ | ä¿æŒé¢œè‰²ä¸€è‡´æ€§ |
| **å›¾è¡¨ç±»å‹** | ç¯å½¢å›¾ | ä¸­é—´å¯æ˜¾ç¤ºæ€»é‡ |
| **å†…å¾„æ¯”ä¾‹** | 50% | æ ‡å‡†ç¯å½¢å›¾ |

### æ•°æ®èšåˆ
```python
# æŒ‰è‚¡ç¥¨èšåˆæœ€è¿‘Næ—¥æˆäº¤é‡
def prepare_volume_distribution(df, period='1M'):
    """
    period: '1M' (æœ€è¿‘1æœˆ), '3M', 'YTD', 'ALL'
    """
    if period == '1M':
        # è·å–æœ€è¿‘1ä¸ªæœˆæ•°æ®
        end_date = df['date'].max()
        start_date = end_date - pd.DateOffset(months=1)
        period_data = df[df['date'] >= start_date]
    else:
        period_data = df

    # æŒ‰è‚¡ç¥¨æ±‡æ€»æˆäº¤é‡
    volume_by_stock = period_data.groupby('symbol')['volume'].sum().reset_index()
    volume_by_stock['percentage'] = volume_by_stock['volume'] / volume_by_stock['volume'].sum() * 100

    return volume_by_stock
```

### ç­›é€‰å™¨é…ç½®
| ç­›é€‰å™¨ | é€‰é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| æ—¶é—´å‘¨æœŸ | 1M, 3M, YTD, å…¨éƒ¨ | 1M | æœ€è¿‘1ä¸ªæœˆ |
| æ˜¾ç¤ºæ–¹å¼ | é¥¼å›¾, ç¯å½¢å›¾, æ—­æ—¥å›¾ | ç¯å½¢å›¾ | å›¾è¡¨ç±»å‹ |
| æœ€å°å æ¯” | 1%, 2%, 5% | 2% | ä½äºæ­¤å€¼çš„åˆå¹¶ä¸º"å…¶ä»–" |

## ğŸ“Š å›¾è¡¨4: YOYå¯¹æ¯”å›¾ (æŸ±çŠ¶å›¾)

### å›¾è¡¨ç±»å‹é€‰æ‹©ä¾æ®
**ä¸ºä»€ä¹ˆé€‰æ‹©åˆ†ç»„æŸ±çŠ¶å›¾ï¼Ÿ**
1. **å¯¹æ¯”æ˜ç¡®**ï¼šæŸ±çŠ¶å›¾é€‚åˆæ¯”è¾ƒç¦»æ•£ç±»åˆ«é—´çš„æ•°å€¼å·®å¼‚[citation:5]
2. **æ—¶é—´å¯¹æ¯”**ï¼šå¹¶åˆ—æ˜¾ç¤ºä¸¤å¹´åŒæœˆæ•°æ®ï¼Œç›´è§‚æ˜¾ç¤ºå¢é•¿/ä¸‹é™
3. **å¤šç»´åº¦**ï¼šå¯åŒæ—¶æ˜¾ç¤ºå¤šä¸ªè‚¡ç¥¨çš„YOYå¯¹æ¯”
4. **æ•°æ®å¯†åº¦**ï¼šæœ‰é™ç©ºé—´å±•ç¤ºå¤šä¸ªæ•°æ®ç‚¹

### å­—æ®µæ˜ å°„é…ç½®
| é…ç½®é¡¹ | å­—æ®µ/å€¼ | è¯´æ˜ |
|--------|---------|------|
| **Xè½´** | `month` | æœˆä»½ (Jan, Feb, ..., Dec) |
| **Yè½´** | `close_price` | æœˆåº¦å¹³å‡æ”¶ç›˜ä»·æˆ–æœˆæœ«æ”¶ç›˜ä»· |
| **åˆ†ç»„** | `year` | å¹´ä»½: 2025 vs 2026 |
| **é¢œè‰²** | å¹´åº¦è‰²ç³» | 2025: æµ…è‰²ç³», 2026: æ·±è‰²ç³» |
| **å›¾è¡¨ç±»å‹** | åˆ†ç»„æŸ±çŠ¶å›¾ | åŒæœˆä¸¤å¹´æ•°æ®å¹¶åˆ— |
| **è¯¯å·®çº¿** | æ ‡å‡†å·® | æ˜¾ç¤ºæœˆåº¦å†…æ³¢åŠ¨èŒƒå›´ |

### æ•°æ®å‡†å¤‡è¯´æ˜
**æ³¨æ„**: å½“å‰æ•°æ®é›†é™åˆ¶
- 2025å¹´æ•°æ®: 10æœˆ, 11æœˆ, 12æœˆ (ä¸å®Œæ•´å¹´åº¦)
- 2026å¹´æ•°æ®: 1æœˆ, 2æœˆ (ä¸å®Œæ•´å¹´åº¦)

**å¤‡é€‰æ–¹æ¡ˆ**:
1. **æœˆåº¦è¡¨ç°å¯¹æ¯”**: å¯¹æ¯”å„æœˆæ”¶ç›Šç‡è€Œéç»å¯¹ä»·æ ¼
2. **æ»šåŠ¨YOY**: å¯¹æ¯”æœ€è¿‘12ä¸ªæœˆ vs å‰12ä¸ªæœˆ
3. **å­£åº¦å¯¹æ¯”**: æŒ‰å­£åº¦èšåˆæ•°æ®

### æ•°æ®é¢„å¤„ç†
```python
def prepare_yoy_comparison(df):
    """å‡†å¤‡YOYå¯¹æ¯”æ•°æ®"""
    # æå–æœˆä»½å’Œå¹´ä»½
    df['year'] = df['date'].dt.year
    df['month'] = df['date'].dt.month

    # è®¡ç®—æœˆåº¦å¹³å‡æ”¶ç›˜ä»·
    monthly_avg = df.groupby(['year', 'month'])['close'].mean().reset_index()

    # æˆ–è€…ä½¿ç”¨æœˆæœ«æ”¶ç›˜ä»·
    monthly_last = df.groupby(['year', 'month']).last().reset_index()

    # åˆ›å»ºå¯¹æ¯”è§†å›¾
    comparison = pd.pivot_table(
        monthly_avg,
        values='close',
        index='month',
        columns='year',
        aggfunc='mean'
    )

    return comparison
```

### ç­›é€‰å™¨é…ç½®
| ç­›é€‰å™¨ | é€‰é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| å¯¹æ¯”æŒ‡æ ‡ | æ”¶ç›˜ä»·, æ”¶ç›Šç‡, æˆäº¤é‡ | æ”¶ç›˜ä»· | å¯¹æ¯”çš„æŒ‡æ ‡ç±»å‹ |
| èšåˆæ–¹å¼ | æœˆå¹³å‡, æœˆæœ«å€¼, æœˆæœ€é«˜ | æœˆå¹³å‡ | æœˆåº¦æ•°æ®èšåˆæ–¹å¼ |
| æ˜¾ç¤ºè‚¡ç¥¨ | å…¨éƒ¨, å•é€‰, å¤šé€‰ | å…¨éƒ¨ | é€‰æ‹©æ˜¾ç¤ºçš„è‚¡ç¥¨ |

## ğŸ”§ æŠ€æœ¯å®ç°å‚è€ƒ

### å›¾è¡¨åº“ä»£ç ç¤ºä¾‹ (Chart.js)
```javascript
// å¤§ç›˜æŒ‡æ•°èµ°åŠ¿å›¾
const spyChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: dateLabels,  // Xè½´: æ—¥æœŸ
    datasets: [{
      label: 'S&P 500 (SPY)',
      data: closePrices, // Yè½´: æ”¶ç›˜ä»·
      borderColor: '#1f77b4',
      backgroundColor: 'rgba(31, 119, 180, 0.1)',
      borderWidth: 2,
      fill: true
    }]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'S&P 500 YTDèµ°åŠ¿' }
    },
    scales: {
      x: { type: 'time', time: { unit: 'month' } },
      y: {
        title: { display: true, text: 'ä»·æ ¼ ($)' },
        beginAtZero: false
      }
    }
  }
});
```

### æ•°æ®æ›´æ–°ç­–ç•¥
1. **å®æ—¶æ›´æ–°**: WebSocketæ¨é€æœ€æ–°ä»·æ ¼
2. **æ¯æ—¥æ›´æ–°**: æ”¶ç›˜åæ›´æ–°å½“æ—¥æ•°æ®
3. **ç¼“å­˜ç­–ç•¥**: å†å²æ•°æ®æœ¬åœ°ç¼“å­˜ï¼Œå‡å°‘APIè°ƒç”¨
4. **å›é€€æœºåˆ¶**: APIå¤±è´¥æ—¶ä½¿ç”¨æœ€åå¯ç”¨æ•°æ®

---
*å›¾è¡¨é…ç½®å®Œæˆï¼Œå¯ç”¨äºå‰ç«¯å¼€å‘å®ç°*